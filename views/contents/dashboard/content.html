<link rel="stylesheet" href="/style/dashboard/product.css">
<script src="//cdn.ckeditor.com/4.16.0/standard/ckeditor.js"></script>
<div class="modal ctn-img" >
    
    <div class="ctn-modal">
        <button class="close-ctn-modal">&#215;</button>
        <div class="form-add-lib">
            
            <input type="file" name="fileToUpload" id="fileToUpload">
            <button class="btn-upload">them anh vao thu vien</button>
           
          
        </div>
        <div class="ctn-all-img">
            
        </div>


    </div>
</div>

<div class="form show-product">
    <h1>Danh muc san pham</h1>
    <div>
        <table>
            <tr>
                <th>stt</th>
                <th>ten san pham</th>
                <th>anh san pham</th>
                <th>gia ban</th>
                <th>sua</th>
                <th>xoa</th>
            </tr>

           
            <tr>
                <td>stt</td>
                <td>ten san pham</td>
                <td>anh san pham</td>
                <td>gia ban</td>
                <td><button>edit</button></td>
                <td><button>xoa</button></td>

            </tr>
            <tr>
                <td>stt</td>
                <td>ten san pham</td>
                <td>anh san pham</td>
                <td>gia ban</td>
                <td><button>edit</button></td>
                <td><button>xoa</button></td>

            </tr>
            <tr>
                <td>stt</td>
                <td>ten san pham</td>
                <td>anh san pham</td>
                <td>gia ban</td>
                <td><button>edit</button></td>
                <td><button>xoa</button></td>

            </tr>
           
           
        </table>
    </div>
</div>

<div class="form insert-product">
    <h1>them san pham moi</h1>
    <div class="form-group form-group1 ">
        <label for="">ten san pham:</label>
        <input class="field"  type="text" name="name" id="name-product">
        <span class="mess-rule"></span>
    </div>
    <div class="form-group form-group1 ">
        <label for="">anh</label>
        <input class="field"   name="img_id" type="text" name="" id="img-product">

        <div class="show-img-select">
        </div>
        <button id="show-modal-img">chon anh</button>
        <span class="mess-rule"></span>
    </div>
    <div class="form-group form-group1 ">
        <label for="">gia san pham:</label>
        <input class="field" name="price" type="text"  id="price-product">
        <span class="mess-rule"></span>

    </div>
    <div class="form-group form-group1 ">
        <label for="">Duong dan seo:</label>
        <input type="text" name="path" id="url-product" class="field">
        <span class="mess-rule"></span>
    </div>
    <div class="form-group form-group1 ">
        <label for="">noi dung:</label>
        <textarea class="field"  name="content" id="editor"></textarea>
        <span class="mess-rule"></span>  
    </div>

    <button class="btn-add-product">Them san pham</button>
</div>

<script >


  </script>



<script type="module" src="/js/dashboard/product.js"></script>

<script>
    let btnAddProduct = document.querySelector('.btn-add-product')

    let getNameImg = document.querySelector('#img-product');
    let ctnSelectImg =  document.querySelector('.show-img-select');
    function remove(el){
        let nameImg = el.parentElement.getAttribute('data-value')+',';
        console.log( nameImg);
        getNameImg.value = getNameImg.value.replace(nameImg, '');
        (el.parentElement.remove())
    }
    function selectImg(el) {
        let urlImg = el.getAttribute('style');
        let nameImg = el.getAttribute('data-value');
        let divImg = `<div class="detail-img"  data-value="${nameImg}" style="${urlImg}">
            <button class="close" onclick="remove(this)">&#10006;</button>
            </div>`;
        ctnSelectImg.innerHTML += divImg;
        getNameImg.value += nameImg +',';
        el.remove();   
    }

    btnAddProduct.onclick = function (){
    var formGroups = document.querySelectorAll('.form-group1');
    let nameProduct = document.querySelector('#name-product')
    let priceProduct = document.querySelector('#price-product')
    let imgProduct = document.querySelector('#img-product')
    let urlProduct = document.querySelector('#url-product') 
    var contentProduct = CKEDITOR.instances.editor.getData();
        $.ajax({
        type: "post",
        url: "/insertproduct",
       
        data: {
            name: nameProduct.value,
            price: priceProduct.value ,
            img_id:imgProduct.value ,
            path: urlProduct.value ,
            content: contentProduct ,
        },
        success: function(response){
            console.log(response);
            let res = JSON.parse(response);
            if(res === 'success'){
                alert("thêm sản phẩm thành công ")
                location.reload();
            } else {
                handleForm(formGroups, res);
            }
        }
    });
}

function deleteProduct(id) {
    $.ajax({
        type: 'get',
        url:'/deleteproduct?id='+id,
        success: function (response){
            console.log(response);
            alert('xoa thanh cong');
            location.reload();
        }
        
    })

}

</script>

